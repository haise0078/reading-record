# テスト駆動開発

## 他国通貨
### 1. 仮実装

実装のサイクルは次の通り。

1. 小さいテストをひとつ書く。
1. 全てのテストを実行し、ひとつ失敗することを確認する。
1. 小さい変更を行う。
1. 再びテストを実行し、全て成功することを確認する。
1. リファクタリングを行い、重複を除去する。

仮実装はコードでまずベタ書きの値を使い、実装を進めるにしたがって変数に置き換えること。

### 2. 明白な実装

明白な実装は頭の中で正しいと思った実装を、すぐにコードに落とすこと。
TDDを行うときは仮実装と明白な実装を行き来しながら開発を進める。

### 3. 三角測量

三角測量は、2つの観点でのテストを同時に通すリファクタリングを行うこと。

### 4. 意図を語るテスト

テストの意図が読み取りやすいようにコーディングする。

### 5. 原則をあえて破るとき

テストが失敗することの確認までは速度重視で、設計の原則を無視しても構わない。
ただし、リファクタすることが前提である。

### 6. テスト不足に気づいたら

リファクタでテスト不足に気づいたら、即座にテストを追加する。

### 7. 疑念をテストに翻訳する

疑念はテストとして表現し、一旦は仮実装でテストを通して放置しても良い。

### 8. 実装を隠す

Factory Methodパターンを用いて、テストコードからサブクラスの実装を隠した。

### 9. 歩幅の調整

TDDでは変更の歩幅（大きさ）を常に微調整する。
細かなステップがやりすぎな場合は歩幅を大きくして、修正に不安を感じるなら歩幅を小さくする。

### 10. テストに聞いてみる

* デバッグ用の処理を実装する場合は、テストを書かずにコードを書いても良い。
* 新しい変更を試して、テストに動くかどうかを聞いてみる。
* テストがレッドバーでプロダクトコードを修正したい場合は、一旦テストをグリーンにしたほうがいい。
そのあとに、プロダクトコードの修正に対するテストを書いてから修正を始める。

### 11. 不要になったら消す

プロダクトコードの修正などで冗長になったテストは削除する。

### 12. 設計とメタファー

よくわからんが、設計にメタファーを使うらしい。

### 13. 実装を導くテスト

必要なオブジェクトの実装を促すテストを作成する。これは一時的なテストであっても問題ない。
このテストを通すために、コンストラクターのみでも問題ないので必要なオブジェクトを実装して先に進んでいく。

### 14. 学習用テストと回帰テスト

* 言語仕様などを確認するために一時的な学習用テストを書くこともある。
* リファクタリング中に想定外の要件が発覚した場合は回帰テストを実装する。
* 実装内部で使うだけのヘルパークラスは個別のテストがなくても、他の実装のテストで担保される。

### 15. テスト任せとコンパイラ任せ

テストが通っておらず変更が連鎖的な場合は二つの道がある。

* テストの抽象度を落として修正の複雑さを下げる。
* コンパイラを信じて連鎖的な変更を順番に処理していく。
